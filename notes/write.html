<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Write a Note - Apple Notes</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">Write a Note</h1>
        <form id="noteForm">
            <div class="mb-3">
                <label for="noteTitle" class="form-label">Title</label>
                <input type="text" class="form-control" id="noteTitle" required>
            </div>
            <div class="mb-3">
                <label for="noteContent" class="form-label">Content</label>
                <textarea class="form-control" id="noteContent" rows="10" required></textarea>
            </div>
            <div class="mb-3">
                <label for="fontSelect" class="form-label">Font</label>
                <select class="form-select" id="fontSelect">
                    <option value="Arial">Arial</option>
                    <option value="Helvetica">Helvetica</option>
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Courier New">Courier New</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="bgColorSelect" class="form-label">Background Color</label>
                <select class="form-select" id="bgColorSelect">
                    <option value="white">White</option>
                    <option value="blue">Blue</option>
                    <option value="purple">Purple</option>
                    <option value="pink">Pink</option>
                    <option value="green">Green</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="textColorSelect" class="form-label">Text Color</label>
                <select class="form-select" id="textColorSelect">
                    <option value="black">Black</option>
                    <option value="white">White</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Save Note</button>
        </form>
        <div class="mt-3">
            <a href="notes.html" class="btn btn-secondary me-2">View Notes</a>
            <a href="index.html" class="btn btn-secondary">Back to Home</a>
        </div>
    </div>

    <script>
    $(document).ready(function() {
        $('#noteForm').submit(function(e) {
            e.preventDefault();
            
            var title = $('#noteTitle').val();
            var content = $('#noteContent').val();
            var font = $('#fontSelect').val();
            var bgColor = $('#bgColorSelect').val();
            var textColor = $('#textColorSelect').val();

            var noteData = JSON.stringify({
                title: title,
                content: content,
                font: font,
                bgColor: bgColor,
                textColor: textColor
            });

            $.ajax({
                url: 'save_note.php',
                method: 'POST',
                data: { note: noteData },
                success: function(response) {
                    if (response === 'success') {
                        Swal.fire({
                            title: 'Note Saved!',
                            text: 'You have 10 seconds to delete this note.',
                            icon: 'success',
                            showCancelButton: true,
                            confirmButtonText: 'Delete',
                            cancelButtonText: 'Keep',
                            timer: 10000,
                            timerProgressBar: true
                        }).then((result) => {
                            if (result.isConfirmed) {
                                $.ajax({
                                    url: 'delete_note.php',
                                    method: 'POST',
                                    data: { title: title },
                                    success: function(deleteResponse) {
                                        if (deleteResponse === 'success') {
                                            Swal.fire('Deleted!', 'Your note has been deleted.', 'success');
                                        } else {
                                            Swal.fire('Error!', 'Failed to delete the note.', 'error');
                                        }
                                    }
                                });
                            }
                        });
                        $('#noteForm')[0].reset();
                    } else {
                        Swal.fire('Error!', 'Failed to save the note.', 'error');
                    }
                },
                error: function() {
                    Swal.fire('Error!', 'An error occurred while saving the note.', 'error');
                }
            });
        });

        $('#fontSelect, #bgColorSelect, #textColorSelect').change(function() {
            $('#noteContent').css({
                'font-family': $('#fontSelect').val(),
                'background-color': $('#bgColorSelect').val(),
                'color': $('#textColorSelect').val()
            });
        });
    });
    </script>
</body>
</html>